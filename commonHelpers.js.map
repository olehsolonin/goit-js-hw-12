{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst KEY = \"44014136-e2da13f55dbc3b2e82126e922\";\n\nexport const fetchPhotosByQuery = async (query, page) => {\n\tconst searchParams = new URLSearchParams({\n\t\tkey: KEY,\n\t\tq: query,\n\t\timage_type: \"photo\",\n\t\torientation: \"horizontal\",\n\t\tsafesearch: true,\n\t\tpage,\n\t\tper_page: 15,\n\t});\n\n\tconst response = await axios.get(`${BASE_URL}?${searchParams}`);\n\tif (response.status !== 200) {\n\t\tthrow new Error(response.statusText);\n\t}\n\treturn response.data;\n};\n","import axios from 'axios';\nexport const createGalleryItemMarkup = (images) => {\n\treturn images.map(\n\t\t({ largeImageURL, id, webformatURL, tags, likes, views, comments, downloads }) =>\n\t\t\t`<li class=\"box-item\">\n\t\t\t\t\t<a class=\"box-link\" href=\"${largeImageURL}\">\n\t\t\t\t\t\t <img\n\t\t\t\t\t\t\t  id=\"${id}\"\n\t\t\t\t\t\t\t  class=\"box-image\"\n\t\t\t\t\t\t\t  src=\"${webformatURL}\"\n\t\t\t\t\t\t\t  alt=\"${tags}\"\n\t\t\t\t\t\t\t  width=\"100%\"\n\t\t\t\t\t\t\t  height=\"152\"\n\t\t\t\t\t\t />\n\t\t\t\t\t</a>\n\t\t\t\t\t<div class=\"image-characteristics\">\n\t\t\t\t\t\t <div class=\"characteristic-item\">\n\t\t\t\t\t\t\t  <h3 class=\"image-title\">Likes</h3>\n\t\t\t\t\t\t\t  <p class=\"image-data\">${likes}</p>\n\t\t\t\t\t\t </div>\n\t\t\t\t\t\t <div class=\"characteristic-item\">\n\t\t\t\t\t\t\t  <h3 class=\"image-title\">Views</h3>\n\t\t\t\t\t\t\t  <p class=\"image-data\">${views}</p>\n\t\t\t\t\t\t </div>\n\t\t\t\t\t\t <div class=\"characteristic-item\">\n\t\t\t\t\t\t\t  <h3 class=\"image-title\">Comments</h3>\n\t\t\t\t\t\t\t  <p class=\"image-data\">${comments}</p>\n\t\t\t\t\t\t </div>\n\t\t\t\t\t\t <div class=\"characteristic-item\">\n\t\t\t\t\t\t\t  <h3 class=\"image-title\">Downloads</h3>\n\t\t\t\t\t\t\t  <p class=\"image-data\">${downloads}</p>\n\t\t\t\t\t\t </div>\n\t\t\t\t\t</div>\n\t\t\t  </li>`\n\t).join('');\n};\n\n\n// console.log(createGalleryItemMarkup(fetchPhotosByQuery()));","import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { fetchPhotosByQuery } from \"./js/pixabay-api.js\";\nimport { createGalleryItemMarkup } from \"./js/render-functions.js\";\n\nconst galleryEl = document.querySelector(\".gallery-box-js\");\nconst searchFormEl = document.querySelector(\".search-form-js\");\nconst loaderEl = document.querySelector(\".loader\");\nconst loadMoreBtnEl = document.querySelector('.load-more');\n\nlet searchQuery = '';\nlet page = 1;\nlet lightbox;\nlet totalHits = 0;\nlet loadedHits = 0;\n\nconst initializeOrUpdateLightbox = () => {\n\tif (lightbox) {\n\t\tlightbox.refresh();\n\t} else {\n\t\tlightbox = new SimpleLightbox('.box-link', {\n\t\t\tcaptions: true,\n\t\t\tcaptionsData: 'alt',\n\t\t\tcaptionDelay: 250,\n\t\t});\n\t}\n};\n\nconst onSearchFormSubmit = async (event) => {\n\tevent.preventDefault();\n\tsearchQuery = event.target.elements.search.value.trim();\n\tpage = 1;\n\tloadedHits = 0;\n\n\tgalleryEl.innerHTML = '';\n\tloaderEl.classList.remove(\"is-hidden\");\n\n\tif (searchQuery === '') {\n\t\tgalleryEl.innerHTML = '';\n\t\tevent.target.reset();\n\t\tloaderEl.classList.add(\"is-hidden\");\n\t\tiziToast.show({\n\t\t\tmessage: 'Input field can not be empty',\n\t\t\tposition: 'topRight',\n\t\t\ttimeout: 2000,\n\t\t\tcolor: 'red',\n\t\t});\n\t\treturn;\n\t}\n\n\t// galleryEl.innerHTML = '';\n\tloadMoreBtnEl.classList.add(\"is-hidden\");\n\t// loaderEl.classList.remove(\"is-hidden\");\n\n\ttry {\n\t\tconst imagesData = await fetchPhotosByQuery(searchQuery, page);\n\t\tloaderEl.classList.add(\"is-hidden\");\n\t\ttotalHits = imagesData.totalHits;\n\t\tloadedHits += imagesData.hits.length;\n\n\t\tif (totalHits === 0) {\n\t\t\tiziToast.show({\n\t\t\t\tmessage: 'Sorry, there are no images for this query',\n\t\t\t\tposition: 'topRight',\n\t\t\t\ttimeout: 2000,\n\t\t\t\tcolor: 'red',\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tconst markup = createGalleryItemMarkup(imagesData.hits);\n\t\tgalleryEl.insertAdjacentHTML(\"afterbegin\", markup);\n\t\tinitializeOrUpdateLightbox();\n\n\t\tif (loadedHits < totalHits) {\n\t\t\tloadMoreBtnEl.classList.remove(\"is-hidden\");\n\t\t}\n\t\telse {\n\t\t\tiziToast.show({\n\t\t\t\tmessage: \"We're sorry, but you've reached the end of search results.\",\n\t\t\t\tposition: 'topRight',\n\t\t\t\ttimeout: 2000,\n\t\t\t\tcolor: 'red',\n\t\t\t});\n\t\t}\n\n\t} catch (error) {\n\t\tconsole.log(error);\n\t} finally {\n\t\tloaderEl.classList.add(\"is-hidden\");\n\t\tevent.target.reset();\n\t}\n};\n\nconst onLoadMore = async () => {\n\tpage += 1;\n\tloaderEl.classList.remove(\"is-hidden\");\n\n\ttry {\n\t\tconst imagesData = await fetchPhotosByQuery(searchQuery, page);\n\t\tloaderEl.classList.add(\"is-hidden\");\n\t\tloadedHits += imagesData.hits.length;\n\n\t\tconst markup = createGalleryItemMarkup(imagesData.hits);\n\t\tgalleryEl.insertAdjacentHTML(\"beforeend\", markup);\n\t\tinitializeOrUpdateLightbox();\n\n\t\tconst cardHeight = document.querySelector('.gallery-box').firstElementChild.getBoundingClientRect().height;\n\t\twindow.scrollBy({\n\t\t\ttop: cardHeight * 2,\n\t\t\tbehavior: 'smooth',\n\t\t});\n\n\t\tif (loadedHits >= totalHits) {\n\t\t\tloadMoreBtnEl.classList.add(\"is-hidden\");\n\t\t\tiziToast.show({\n\t\t\t\tmessage: \"We're sorry, but you've reached the end of search results.\",\n\t\t\t\tposition: 'topRight',\n\t\t\t\ttimeout: 2000,\n\t\t\t\tcolor: 'red',\n\t\t\t});\n\t\t}\n\n\t} catch (error) {\n\t\tconsole.log(error);\n\t\t// loaderEl.classList.add(\"is-hidden\");\n\t} finally {\n\t\tloaderEl.classList.add(\"is-hidden\");\n\t}\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMore);"],"names":["BASE_URL","KEY","fetchPhotosByQuery","query","page","searchParams","response","axios","createGalleryItemMarkup","images","largeImageURL","id","webformatURL","tags","likes","views","comments","downloads","galleryEl","searchFormEl","loaderEl","loadMoreBtnEl","searchQuery","lightbox","totalHits","loadedHits","initializeOrUpdateLightbox","SimpleLightbox","onSearchFormSubmit","event","iziToast","imagesData","markup","error","onLoadMore","cardHeight"],"mappings":"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"}